(this["webpackJsonpfrontend-v2"]=this["webpackJsonpfrontend-v2"]||[]).push([[0],{17:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(1),s=a.n(r),i=a(10),l=a.n(i),c=a(2),o=a(4),u=a(6),d=a(5),m=a(3),p=a.n(m),j=a(8),h=window.location.href,b=new(function(){function e(){Object(c.a)(this,e),this.login=function(){var e=Object(j.a)(p.a.mark((function e(t,a,n){var r,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify({email:t,password:a})},e.prev=1,e.next=4,fetch("".concat(h,"user/login"),r);case 4:if(200!==(s=e.sent).status){e.next=16;break}return e.next=8,s.json();case 8:s=e.sent,localStorage.setItem("authenticated",!0),localStorage.setItem("userName",s.user.name),localStorage.setItem("userLastName",s.user.lastName),localStorage.setItem("token",s.token),n(),e.next=17;break;case 16:n(400);case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(1),console.log(e.t0),n("B\u0142\u0105d serwera");case 23:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(t,a,n){return e.apply(this,arguments)}}(),this.register=function(){var e=Object(j.a)(p.a.mark((function e(t,a,n,r,s){var i,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(h,"user"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,lastName:a,email:n,password:r})});case 3:return i=e.sent,e.next=6,i.json();case 6:(l=e.sent).code&&11e3===l.code?s(11e3):201===i.status?(localStorage.setItem("authenticated",!0),localStorage.setItem("userName",l.user.name),localStorage.setItem("userLastName",l.user.lastName),localStorage.setItem("token",l.token),s()):s(400),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),s("B\u0142\u0105d serwera");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a,n,r,s){return e.apply(this,arguments)}}(),this.logout=function(){var e=Object(j.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(h,"user/logout"),{method:"POST",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}});case 3:localStorage.removeItem("authenticated"),localStorage.removeItem("userName"),localStorage.removeItem("userLastName"),localStorage.removeItem("token"),t(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),t("B\u0142\u0105d serwera");case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}()}return Object(o.a)(e,[{key:"isAuthenticated",value:function(){return localStorage.getItem("authenticated")}}]),e}()),g=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={email:null,password:null,name:null,lastName:null,error:null,registratrion:!1,loading:null},e.handlerLogin=function(t){t.preventDefault(),b.login(e.state.email,e.state.password,e.loginCb),e.setState({loading:Object(n.jsx)("h3",{children:"Przetwarzanie..."})})},e.loginCb=function(t){t?400===t?e.setState({error:Object(n.jsx)("h3",{children:"Z\u0142e dane!"}),loading:null}):e.setState({error:Object(n.jsx)("h3",{children:"Problem z serwerem, zg\u0142o\u015b do admina."}),loading:null}):e.props.setStateHandler({logged:!0})},e.handlerRegister=function(t){t.preventDefault(),b.register(e.state.name,e.state.lastName,e.state.email,e.state.password,e.registerCb),e.setState({loading:Object(n.jsx)("h3",{children:"Przetwarzanie..."})})},e.registerCb=function(t){t?11e3===t?e.setState({error:Object(n.jsx)("h3",{children:"Istnieje ju\u017c konto na podanym emailu."}),loading:null}):400===t?e.setState({error:Object(n.jsx)("h3",{children:"Z\u0142e dane!"}),loading:null}):e.setState({error:Object(n.jsx)("h3",{children:"Problem z serwerem, zg\u0142o\u015b do admina."}),loading:null}):e.props.setStateHandler({logged:!0})},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return this.state.registratrion?Object(n.jsxs)("div",{className:"page",children:[Object(n.jsxs)("form",{className:"regForm",onSubmit:function(t){e.handlerRegister(t)},children:[Object(n.jsx)("h2",{className:"regForm__title",children:"Rejestracja"}),Object(n.jsx)("label",{className:"regForm__label",htmlFor:"nameInput",children:"Imi\u0119"}),Object(n.jsx)("input",{className:"regForm__input",id:"nameInput",type:"text",onChange:function(t){e.setState({name:t.target.value})},autoComplete:"given-name",required:!0}),Object(n.jsx)("label",{className:"regForm__label",htmlFor:"lastNameInput",children:"Nazwisko"}),Object(n.jsx)("input",{className:"regForm__input",id:"lastNameInput",type:"text",onChange:function(t){e.setState({lastName:t.target.value})},autoComplete:"family-name",required:!0}),Object(n.jsx)("label",{className:"regForm__label",htmlFor:"emailInput",children:"Email"}),Object(n.jsx)("input",{className:"regForm__input",id:"emailInput",type:"text",onChange:function(t){e.setState({email:t.target.value})},autoComplete:"email",required:!0}),Object(n.jsx)("label",{className:"regForm__label",htmlFor:"passwordInput",children:"Has\u0142o"}),Object(n.jsx)("input",{className:"regForm__input",id:"passwordInput",type:"password",onChange:function(t){e.setState({password:t.target.value})},autoComplete:"new-password",required:!0}),this.state.loading,this.state.error,Object(n.jsx)("input",{className:"regForm__submit",type:"submit",value:"Zarejestruj"}),Object(n.jsx)("p",{className:"regForm__p",children:"Masz ju\u017c konto ?"}),Object(n.jsx)("button",{className:"regForm__button",onClick:function(){return e.setState({registratrion:!1})},children:"Logowanie"})]}),Object(n.jsx)("footer",{className:"footer",children:"Kontakt: ksiazka-serwisowa@gmail.com | \xa92020"})]}):Object(n.jsxs)("div",{className:"page",children:[Object(n.jsxs)("form",{className:"loginForm",onSubmit:function(t){e.handlerLogin(t)},children:[Object(n.jsx)("h2",{className:"loginForm__title",children:"Logowanie"}),Object(n.jsx)("label",{className:"loginForm__label",htmlFor:"emailInput",children:"Email"}),Object(n.jsx)("input",{className:"loginForm__input",id:"emailInput",type:"text",onChange:function(t){e.setState({email:t.target.value})},autoComplete:"email",required:!0}),Object(n.jsx)("label",{className:"loginForm__label",htmlFor:"passwordInput",children:"Has\u0142o"}),Object(n.jsx)("input",{className:"loginForm__input",id:"passwordInput",type:"password",onChange:function(t){e.setState({password:t.target.value})},autoComplete:"current-password",required:!0}),this.state.loading,this.state.error,Object(n.jsx)("input",{className:"loginForm__submit",type:"submit",value:"Zaloguj"}),Object(n.jsx)("p",{className:"loginForm__p",children:"Zarejestruj si\u0119 za darmo."}),Object(n.jsx)("button",{className:"loginForm__button",onClick:function(){return e.setState({registratrion:!0})},children:"Rejestracja"})]}),Object(n.jsx)("footer",{className:"footer",children:"Kontakt: ksiazka-serwisowa@gmail.com | \xa92020"})]})}}]),a}(r.Component),f=new function e(){Object(c.a)(this,e),this.create=function(){var e=Object(j.a)(p.a.mark((function e(t,a,n){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:"post",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({name:t,fields:a})},e.prev=1,e.next=4,fetch("".concat(h,"equipment"),r);case 4:201===e.sent.status?n():n("B\u0142\u0105d serwera"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),n("B\u0142\u0105d serwera");case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,a,n){return e.apply(this,arguments)}}(),this.getAll=function(){var e=Object(j.a)(p.a.mark((function e(t){var a,n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={method:"get",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}},e.prev=1,e.next=4,fetch("".concat(h,"equipment"),a);case 4:if(200!==(n=e.sent).status){e.next=12;break}return e.next=8,n.json();case 8:r=e.sent,t(r),e.next=13;break;case 12:t("B\u0142\u0105d serwera");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),t("B\u0142\u0105d serwera");case 18:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t){return e.apply(this,arguments)}}(),this.update=function(){var e=Object(j.a)(p.a.mark((function e(t,a){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(t)},e.prev=1,e.next=4,fetch("".concat(h,"equipment"),n);case 4:200===e.sent.status?a():a("B\u0142\u0105d serwera"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a("B\u0142\u0105d serwera");case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,a){return e.apply(this,arguments)}}(),this.delete=function(){var e=Object(j.a)(p.a.mark((function e(t,a){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"delete",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify({equipmentId:t})},e.prev=1,e.next=4,fetch("".concat(h,"equipment"),n);case 4:200===(r=e.sent).status?a():404===r.status?a(404):a("B\u0142\u0105d serwera"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a("B\u0142\u0105d serwera");case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,a){return e.apply(this,arguments)}}()},O=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={fetching:Object(n.jsx)("h3",{children:"\u0141adowanie"}),error:null,equipments:null,search:null},e.componentDidMount=function(){f.getAll(e.getAllCb)},e.getAllCb=function(t){Array.isArray(t)?e.setState({fetching:null,equipments:t}):e.setState({fetching:null,error:t})},e.handleDelete=function(t){window.confirm("Napewno chcesz usun\u0105\u0107 element ?")&&f.delete(t,(function(t){t?e.props.setStateHandler({error:Object(n.jsx)("h3",{children:"Ups... Co\u015b posz\u0142o nie tak!"})}):window.location.reload(!1)}))},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=this.state.equipments?this.state.equipments.filter((function(t){return null==e.state.search||t.name.toLowerCase().includes(e.state.search.toLowerCase())?t:null})).map((function(t,a){return Object(n.jsxs)("section",{className:"preview__elementContainer",children:[Object(n.jsx)("h2",{className:"previwe__elementName",children:t.name}),t.fields?t.fields.map((function(e,t){return Object(n.jsxs)("aside",{className:"preview__fieldContainer",children:[Object(n.jsx)("header",{className:"preview__fieldName",children:e.name}),Object(n.jsx)("p",{className:"preview__fieldValue",children:e.value})]},t)})):null,Object(n.jsxs)("div",{className:"preview__elementButtonsConainer",children:[Object(n.jsx)("button",{className:"preview__elementDeleteButton",onClick:function(){e.handleDelete(t._id)},children:"Usu\u0144"}),Object(n.jsx)("button",{className:"preview__elementEditButton",onClick:function(){e.props.setStateHandler({edit:t})},children:"Edytuj"})]})]},a)})):null;return Object(n.jsxs)("main",{className:"preview",children:[Object(n.jsxs)("section",{className:"preview__searchAndAdd",children:[Object(n.jsx)("input",{className:"preview__searchInput",onChange:function(t){e.setState({search:t.target.value})},autoComplete:"off",placeholder:"Wyszukiwarka"}),Object(n.jsx)("button",{className:"preview__addButton",onClick:function(){e.props.setStateHandler({adding:!0})},children:"Dodaj nowy"})]}),Object(n.jsxs)("section",{className:"preview__content",children:[this.state.fetching,this.state.error,t]})]})}}]),a}(r.Component),x=a(7),v=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={name:null,fields:[],loading:!1,error:null},e.handlerAdding=function(t){t.preventDefault(),f.create(e.state.name,e.state.fields,e.createCb),e.setState({loading:Object(n.jsx)("h3",{children:"Przetwarzanie..."})})},e.createCb=function(t){t?e.setState({loading:null,error:"Ups... co\u015b posz\u0142o nie tak!"}):e.props.setStateHandler({adding:!1})},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this;return console.log(this.state),Object(n.jsxs)("main",{className:"adding",children:[Object(n.jsx)("header",{className:"adding__title",children:Object(n.jsx)("h3",{className:"adding__titleText",children:"Dodawanie nowego sprz\u0119tu"})}),Object(n.jsx)("button",{className:"adding__canelButton",onClick:function(){e.props.setStateHandler({adding:!1})},children:"Anuluj"}),Object(n.jsxs)("form",{className:"adding__form",onSubmit:function(t){e.handlerAdding(t)},children:[Object(n.jsx)("label",{className:"adding__label",children:"Nazwa"}),Object(n.jsx)("input",{className:"adding__input",type:"text",onChange:function(t){e.setState({name:t.target.value})},required:!0}),Object(n.jsx)("h4",{className:"adding__fieldsTitle",children:"Rubryki na dane: "}),this.state.fields?this.state.fields.map((function(t,a){return Object(n.jsxs)("div",{className:"adding__fieldsContainer",children:[Object(n.jsx)("label",{className:"adding__label",children:"Nazwa rubruki: "}),Object(n.jsx)("input",{className:"adding__input",type:"text",onChange:function(t){var n=Object(x.a)(e.state.fields);n[a].name=t.target.value,e.setState({fields:n})},required:!0}),Object(n.jsx)("label",{className:"adding__label",children:"Dane: "}),Object(n.jsx)("textarea",{className:"adding__textarea",placeholder:"Wprowad\u017a zawarto\u015b\u0107 pola (opcjonalne)...",type:"text",onChange:function(t){var n=Object(x.a)(e.state.fields);n[a].value=t.target.value,e.setState({fields:n})}}),Object(n.jsx)("button",{className:"adding__deleteFieldButton",type:"button",onClick:function(){var t=Object(x.a)(e.state.fields);t.splice(a,1),e.setState({fields:t})},children:"Usu\u0144 rubryk\u0119"})]},a)})):null,Object(n.jsx)("button",{className:"adding__addFieldButton",type:"button",onClick:function(){e.setState((function(e){return{fields:[].concat(Object(x.a)(e.fields),[{name:null,value:null}])}}))},children:"Dodaj rubryk\u0119"}),this.state.loading,this.state.error,Object(n.jsx)("input",{className:"adding__submit",type:"submit",value:"Utw\xf3rz"})]})]})}}]),a}(r.Component),_=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={equipmentName:e.props.equipment.name,equipmentFields:e.props.equipment.fields,error:null},e.handlerEdit=function(t){t.preventDefault(),f.update({equipmentId:e.props.equipment._id,name:e.state.equipmentName,fields:e.state.equipmentFields},e.saveCb),e.setState({loading:Object(n.jsx)("h3",{children:"Przetwarzanie..."})})},e.saveCb=function(t){t?e.setState({loading:null,error:"Ups... co\u015b posz\u0142o nie tak!"}):e.props.setStateHandler({edit:!1})},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=this.state.equipmentFields?this.state.equipmentFields.map((function(t,a){return Object(n.jsxs)("span",{className:"edit__fieldsContainer",children:[Object(n.jsx)("label",{className:"edit__label",children:"Nazwa rubryki"}),Object(n.jsx)("input",{className:"edit__input",type:"text",value:t.name,onChange:function(t){var n=Object(x.a)(e.state.equipmentFields);n[a].name=t.target.value,e.setState({equipmentFields:n})},required:!0}),Object(n.jsx)("label",{className:"edit__label",children:"Dane rubryki"}),Object(n.jsx)("textarea",{className:"edit__textarea",value:t.value,onChange:function(t){var n=Object(x.a)(e.state.equipmentFields);n[a].value=t.target.value,e.setState({equipmentFields:n})}}),Object(n.jsx)("button",{className:"adding__deleteFieldButton",type:"button",onClick:function(){var t=Object(x.a)(e.state.equipmentFields);t.splice(a,1),e.setState({equipmentFields:t})},children:"Usu\u0144 rubryk\u0119"})]},a)})):null;return Object(n.jsxs)("main",{className:"edit",children:[Object(n.jsx)("header",{className:"edit__titleContainer",children:Object(n.jsxs)("h3",{className:"edit__titleText",children:["Edytowanie: ",this.state.equipmentName,Object(n.jsx)("button",{className:"edit__canelButton",onClick:function(){e.props.setStateHandler({edit:!1})},children:"Anuluj"})]})}),Object(n.jsxs)("form",{className:"edit__form",onSubmit:function(t){e.handlerEdit(t)},children:[Object(n.jsx)("label",{className:"edit__label",children:"Nazwa"}),Object(n.jsx)("input",{className:"edit__input",type:"text",value:this.state.equipmentName,onChange:function(t){e.setState({equipmentName:t.target.value})}}),t,Object(n.jsx)("button",{className:"edit__addFieldButton",type:"button",onClick:function(){e.setState((function(e){return{equipmentFields:[].concat(Object(x.a)(e.equipmentFields),[{name:"",value:""}])}}))},children:"Dodaj rubryk\u0119"}),Object(n.jsx)("input",{className:"edit__submit",type:"submit",value:"Zapisz"})]})]})}}]),a}(r.Component),N=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={edit:!1,adding:!1,fetching:!0,equipment:null,error:null,deleting:null},e.setStateHandler=function(t){e.setState(t)},e.logoutCb=function(t){t||e.props.setStateHandler({logged:!1})},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this,t=null;return t=this.state.adding?Object(n.jsx)(v,{setStateHandler:this.setStateHandler}):this.state.edit?Object(n.jsx)(_,{setStateHandler:this.setStateHandler,equipment:this.state.edit}):Object(n.jsx)(O,{setStateHandler:this.setStateHandler}),Object(n.jsxs)("div",{children:[Object(n.jsxs)("header",{className:"topBar",children:[Object(n.jsx)("h2",{className:"topBar__h2",children:"Ksi\u0105\u017cka Serwisowa"}),Object(n.jsx)("button",{className:"topBar__button",onClick:function(){b.logout(e.logoutCb)},children:"Wyloguj"})]}),t,Object(n.jsx)("footer",{className:"footer",children:"Kontakt: email@ex.com | \xa9 2020"})]})}}]),a}(r.Component),w=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={logged:localStorage.getItem("authenticated")},e.setStateHandler=function(t){e.setState(t)},e}return Object(o.a)(a,[{key:"render",value:function(){return this.state.logged?Object(n.jsx)(N,{setStateHandler:this.setStateHandler}):Object(n.jsx)(g,{setStateHandler:this.setStateHandler})}}]),a}(r.Component);l.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(w,{})}),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.fe50b581.chunk.js.map